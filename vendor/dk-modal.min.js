!function(){"use strict";function e(e){return $.each(e,function(t,o){"string"==typeof e[t]&&(e[t]=e[t].trim())}),["offsetTop","offsetLeft","width","height"].forEach(function(t,o){("number"==typeof e[t]||"string"==typeof e[t]&&/^\d+$/.test(e[t]))&&(e[t]=e[t]+"px")}),"string"==typeof e.targetOffset&&(e.targetOffset=parseFloat(e.targetOffset)),e.test&&"mobile"==e.test.mode?t=!0:e.test&&"desktop"==e.test.mode&&(t=!1),e}var t=(console.log.bind(console),-1!=window.navigator.userAgent.indexOf("Mobi"));if(!$)throw new Error("dkModal depends on jquery");if(!angular)throw new Error("dkModal depends on angular");var o=angular.module("dkModal",["ngAnimate","ngTouch","ngSanitize"]);o.run(["$rootScope",function(e){function t(t,o){e.$regScopes=e.$regScopes||{},e.$regScopes[t]=o}e.$regScope=t}]),o.provider("dkModal",function(){var o=767,n=27,r=2,i="96%",a={},d={popup:void 0,selector:void 0,template:void 0,templateUrl:void 0,key:!0,click:!0,offsetTop:void 0,offsetLeft:void 0,target:void 0,targetSide:"right",targetVert:"middle",targetOffset:8,width:void 0,height:void 0,backdropColor:void 0,cancelEventName:"modalCancel",okEventName:"modalOk",defaultClose:!0,defaultHeader:void 0,defaultBody:"",defaultFooter:void 0,test:{mobileView:!1}};return a.setDefaults=function(t){angular.extend(d,e(t))},a.$get=["$http","$templateCache","$compile","$animate","$rootScope","$timeout","$q",function(a,l,s,c,f,p,h){return function(u){function g(e){return f.$apply(function(){M.hide("ok")}),!1}function w(e){return f.$apply(function(){M.hide("cancel")}),!1}function m(e){return e.which==n&&f.$apply(function(){M.hide("cancel")}),!1}function k(){return f.$apply(function(){M.hide("cancel")}),!1}function v(){function t(){angular.extend(C,e(x.data()),e(u)),o.resolve()}var o=h.defer();if(!C.selector&&!C.template&&!C.templateUrl)throw new Error("Must set either selector or templateUrl");if(C.template){if(!C.scope)throw new Error("Scope is required with template option");x=s(C.template)(C.scope),x&&0!==x.length?t():o.reject(new Error("Failed to get compile modal for template"))}else if(C.templateUrl){if(!C.scope)throw new Error("scope is required with templateUrl option");if("default"==C.templateUrl||"dkModalTemplate.html"==C.templateUrl){C.templateUrl="dkModalTemplate.html";var n=C.scope.$new();n.close=C.defaultClose,n.header=C.scope.$eval(C.defaultHeader),n.body=C.scope.$eval(C.defaultBody),n.footer=C.defaultFooter,C.scope=n}var r;(r=l.get(C.templateUrl))?(x=s(r)(C.scope),x&&0!==x.length?t():o.reject(new Error("Failed to get compile modal for templateUrl: "+C.templateUrl))):a.get(C.templateUrl).then(function(e){l.put(C.templateUrl,e.data),x=s(e.data)(C.scope),x&&0!==x.length?t():o.reject(new Error("Failed to get compile modal for templateUrl: "+C.templateUrl))},function(e){o.reject(new Error("Failed to get modal for template: "+C.templateUrl))})}else C.selector&&(U=!0,x=$(C.selector),0===x.length?o.reject(new Error("Failed to find modal from selector: "+C.selector)):t());return o.promise}function b(){var e,n,a,d;if(a=t&&window.innerWidth<=o,d=x.find("input, select, textarea").length>0,x.find(".exit-ok").click(g),x.find(".exit-cancel").click(w),x.addClass("dk-modal"),x.attr("tabindex","-1"),C.key&&x.on("keyup",m),C.width){var l=-1!=C.width.indexOf("%")?window.innerWidth*parseInt(C.width)/100:parseInt(C.width);l=l>window.innerWidth?window.innerWidth+"px":C.width,x.css("width",l)}else x.css("width","");var s=window.innerWidth*(r/100);if(C.height){var p=-1!=C.height.indexOf("%")?window.innerHeight*parseInt(C.height)/100:parseInt(C.height);p=a&&p+s>window.innerHeight?window.innerHeight-s+"px":p>window.innerHeight?window.innerHeight+"px":C.height,x.css("height",p)}else x.css("height","");x.css("left","-9999px"),x.show(),U||$(document.body).prepend(x);var h=x.outerWidth(),u=x.outerHeight();if(x.hide(),x.css("left",""),u+(a?s:0)>window.innerHeight&&(u=window.innerHeight-(a?s:0),x.css("height",u+"px")),x.css("top",""),x.css("left",""),x.css("transform",""),a&&d)x.css("transform","translate(0,0)"),x.css("top",s+"px"),x.css("left",r+"%"),x.css("width",i);else if(C.target){x.css("transform","translate(0,0)");var v=C.targetSide||"right",b=$(C.target);if(!b.length)throw new Error("Failed to locate target: "+C.target);var E=b.offset(),H=b.outerWidth(),T=b.outerHeight();"right"==v?e=E.left+H+C.targetOffset+h<window.innerWidth?E.left+H+C.targetOffset:window.innerWidth-h:"left"==v&&(e=E.left-C.targetOffset-h>0?E.left-C.targetOffset-h:0),"top"==C.targetVert?n=E.top:"middle"==C.targetVert?n=E.top-u/2+T/2:"bottom"==C.targetVert&&(n=E.top-u+T),0>n&&(n=0),n+u>window.innerHeight&&(n=window.innerHeight-u),x.css("top",n+"px"),x.css("left",e+"px")}else if(C.offsetTop&&C.offsetLeft){x.css("transform","translate(0,0)");var O=-1!=C.offsetTop.indexOf("%")?window.innerHeight*parseInt(C.offsetTop)/100:parseInt(C.offsetTop),W=-1!=C.offsetLeft.indexOf("%")?window.innerWidth*parseInt(C.offsetLeft)/100:parseInt(C.offsetLeft);n=O+u<window.innerHeight?C.offsetTop:window.innerHeight-u+"px",e=W+h<window.innerWidth?C.offsetLeft:window.innerWidth-h+"px",x.css("top",n),x.css("left",e)}else x.css("top",window.innerHeight/2-u/2+"px"),x.css("left",window.innerWidth/2-h/2+"px");y=$('<div tabindex="-1" class="dk-modal-backdrop"></div>'),C.backdropColor&&y.css("background-color","none"==C.backdropColor?"rgba(0,0,0,0)":C.backdropColor),C.click&&y.click(k),C.key&&y.keyup(m),C.popup&&(y.addClass("popup"),x.addClass("popup")),$("body").prepend(y),y.show(),c.addClass(y,"open"),x.show();var S=x.find("[autofocus]");S.length>0?S.focus():x.focus(),c.addClass(x,"open").then(function(){x.trigger("show")}),f.dkModalInstance=M}var x,y,M={},U=!1,C=angular.extend({},d,e(u));return M.hide=function(e){U&&(x.find(".exit-ok").off("click",g),x.find(".exit-cancel").off("click",w),x.off("keyup",m)),c.removeClass(y,"open").then(function(){y.remove()}),c.removeClass(x,"open").then(function(){var t="ok"==e?C.okEventName:C.cancelEventName;x.trigger(t),C.scope?C.scope.$broadcast(t):f.$broadcast(t),U?x.hide():x.remove(),x=void 0})},M.show=function(){var e=h.defer(),t=e.promise;return v().then(function(){p(function(){b(),e.resolve(x)})},function(t){e.reject(t)}),t},M}}],a}),o.directive("dkModalTrigger",function(){return{restrict:"A",controller:["$scope","$element","$attrs","dkModal",function(t,o,n,r){o.click(function(){var i=e(o.data());if(i.scope=t,n.dkModalTrigger&&/.html$/i.test(n.dkModalTrigger)?i.templateUrl=n.dkModalTrigger:!i.selector&&n.dkModalTrigger&&(i.selector=n.dkModalTrigger),!i.templateUrl&&!i.selector)throw new Error("dkModal: Must supply either a templateUrl or selector");"this"==i.target&&(i.target=o),t.$apply(function(){r(i).show()})})}]}});var n='<div class="dk-modal"> <span class="dk-modal-close exit-cancel" ng-show="close">&times;</span> <div class="dk-modal-header" ng-show="header" ng-bind-html="header"></div> <div class="dk-modal-body" ng-bind-html="body"></div> <div class="dk-modal-footer" ng-show="footer"> <button class="btn btn-default exit-cancel dk-modal-button-no" ng-show="footer == \'yesno\'">No</button> <button class="btn btn-default exit-ok dk-modal-button-yes" ng-show="footer == \'yesno\'">Yes</button> <button class="btn btn-default exit-cancel dk-modal-button-cancel" ng-show="footer == \'okcancel\'">Cancel</button> <button class="btn btn-default exit-ok dk-modal-button-ok"                            ng-show="footer == \'okcancel\' || footer == \'ok\'">OK</button> </div> </div>';o.run(["$templateCache",function(e){e.put("dkModalTemplate.html",n)}])}();